** DISPUTED ** CMCAgent in NCR Command Center Agent 16.3 on Aloha
 POS/BOH servers permits the submission of a runCommand parameter
 (within an XML document sent to port 8089) that enables the remote,
 unauthenticated execution of an arbitrary command as SYSTEM, as
 exploited in the wild in 2020 and/or 2021. NOTE: the vendor's position
 is that exploitation occurs only on devices with a certain "misconfiguration."  

 ------------------------------------------

 [Additional Information]
 Contacted the vendor in June of 2020 after discovery this is being
 exploited in the wild and targeting the POS systems. The threat actor
 has established c2 domains that blend in. I am also on a thread with
 CISA and the vendor discussing a public disclosure date. Vendor
 insists this is a 'misconfiguration' by the clients but Tetra has
 observed the vulnerability exploited in the wild.  Tetra has created a working POC exploit. I can provide the exploit POC upon request. Download link to
 the CMC agent installer is in the references box

 ------------------------------------------

 [VulnerabilityType Other]
 Permits the submission of a command parameter that enables the remote, unauthenticated execution of an arbitrary command as SYSTEM.

 ------------------------------------------

 [Vendor of Product]
 NCR

 ------------------------------------------

 [Affected Product Code Base]
 CMC Agent - Tested on v16.3 but likely

 ------------------------------------------

 [Affected Component]
 CMCAgent that runs on the Aloha POS/BOH servers is vulnerable to receiving a command that executes the parameter passed in as SYSTEM.

 ------------------------------------------

 [Attack Type]
 Remote

 ------------------------------------------

 [Impact Code execution]
 true

 ------------------------------------------

 [Impact Denial of Service]
 true

 ------------------------------------------

 [Impact Escalation of Privileges]
 true

 ------------------------------------------

 [Impact Information Disclosure]
 true

 ------------------------------------------

 [Attack Vectors]
 CMCAgent that runs on the Aloha POS/BOH servers listens on port 8089.
 To exploit the system you have to send a specially crafted XML request
 that contains the commands that you would like to execute. If you pass
 a command as a parameter to the runCommand function you can execute
 that command as system. For the POC, I executed it remotely against a
 virtual machine that had the CMC Agent running. I created several
 requests and executed cmd.exe, powershell.exe and calc.exe. All
 processes spawned under the 'SYSTEM' user and were running in the
 background. I did change the workitem number but not sure if that
 really makes a difference. Additionally, if you connect to the port
 the server will return a response with the hostname of the system as
 well as other information indicating the system is running Aloha
 software. You can do a shodan search for the banner and see the NCR
 customers that have the CMC agent publicity exposed.

 ------------------------------------------

 [Reference]
 https://rdf2.alohaenterprise.com/client/CMCInst.zip
 https://www.shodan.io/search?query=mynodename
 https://www.tetradefense.com/incident-response-services/active-exploit-a-remote-code-execution-rce-vulnerability-for-ncr-aloha-point-of-sale/
 https://www.ncr.com/


 ------------------------------------------

 [Discoverer]
 Kyle Pagelow from Tetra Defense
